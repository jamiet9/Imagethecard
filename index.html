<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Minecraft Bingo Card Renderer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9f9f9;
      padding: 20px;
      text-align: center;
    }
    h1 {
      margin-bottom: 20px;
    }
    textarea {
      width: 100%;
      height: 200px;
      font-family: monospace;
      margin-bottom: 10px;
      padding: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-bottom: 20px;
      cursor: pointer;
    }
    #cardContainer {
      margin-top: 20px;
    }
    table {
      border-collapse: collapse;
      margin: 0 auto;
      table-layout: fixed;
    }
    td {
      border: 1px solid #333;
      width: 100px;
      height: 100px;
      padding: 5px;
      vertical-align: top;
      text-align: center;
      font-size: 10px;
      overflow: hidden;
    }
    td img {
      width: 60px;
      height: 60px;
      display: block;
      margin: 0 auto;
    }
  </style>
</head>
<body>
  <h1>Minecraft Bingo Card Renderer</h1>
  <p>Paste your list of results below (one cell per line).  
  If a line starts with a rarity keyword (e.g. “Very Common”, “Common”, “Uncommon”, “Rare”, or “Super Rare”) followed by a tab, that rarity will be used; otherwise the line is taken as the item name.</p>
  <textarea id="inputList" placeholder="Example:
Very Common	EGG
Rare	DIAMOND_ORE
SPRUCE_BUTTON"></textarea>
  <br>
  <button id="renderButton">Render Card</button>
  <div id="cardContainer"></div>

  <script>
    /********** RARITY STYLE MAPPING **********/
    const categoryMapping = {
      "Very Common": { color: "#FFD700", textColor: "#000" },
      "Common": { color: "#FFFFFF", textColor: "#000" },
      "Uncommon": { color: "#32CD32", textColor: "#FFF" },
      "Rare": { color: "#1E90FF", textColor: "#FFF" },
      "Super Rare": { color: "#8A2BE2", textColor: "#FFF" }
    };

    /********** IMAGE URL GENERATOR **********/
    // This function converts an item name (in all caps with underscores)
    // into Title Case (e.g. "DIAMOND_PICKAXE" -> "Diamond Pickaxe")
    // then builds a generic image URL using a common pattern from the Minecraft Wiki.
    // (Note: Not every item may follow this pattern; you may add exceptions as needed.)
    function getItemImage(itemName) {
      // Convert the item name to Title Case
      let properName = itemName.toLowerCase().split('_')
        .map(word => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ');
      // Build the filename by replacing spaces with underscores.
      // Here we assume the image filename is of the form "Proper_Name_JE2_BE2.png".
      let fileName = properName.replace(/\s+/g, '_') + "_JE2_BE2.png";
      let url = "https://minecraft.wiki/w/" + properName + "#/media/File:" + fileName;
      return url;
    }

    /********** INPUT PARSING **********/
    // This function parses the pasted text.
    // Each line is split on the tab character.
    // If two parts are found, the first is taken as the rarity and the second as the item.
    // If only one part is found, it is taken as the item and rarity is left blank.
    function parseInput(text) {
      let lines = text.split("\n").map(line => line.trim()).filter(line => line !== "");
      let cells = [];
      lines.forEach(line => {
        let parts = line.split("\t");
        if (parts.length >= 2) {
          // First part is rarity, remaining parts (joined) are the item name.
          let rarity = parts[0].trim();
          let item = parts.slice(1).join(" ").trim();
          cells.push({ item: item, rarity: rarity });
        } else {
          // Only one token: treat as item name; rarity will be blank.
          cells.push({ item: line, rarity: "" });
        }
      });
      return cells;
    }

    /********** RENDERING THE GRID **********/
    function renderCard(cells) {
      // Determine grid size (n x n) that can hold all cells.
      let total = cells.length;
      let n = Math.ceil(Math.sqrt(total));
      let table = document.createElement("table");
      let cellIndex = 0;
      for (let i = 0; i < n; i++) {
        let tr = document.createElement("tr");
        for (let j = 0; j < n; j++) {
          let td = document.createElement("td");
          if (cellIndex < total) {
            let cellData = cells[cellIndex];
            // Get image URL for the item
            let imgUrl = getItemImage(cellData.item);
            // Build inner HTML: image on top, then item name and rarity
            let rarityText = cellData.rarity ? cellData.rarity : "";
            td.innerHTML = `<img src="${imgUrl}" alt="${cellData.item}"><br>
                            <span>${cellData.item}<br>${rarityText}</span>`;
            // If rarity is one of our known categories, apply background style
            if (categoryMapping[cellData.rarity]) {
              td.style.backgroundColor = categoryMapping[cellData.rarity].color;
              td.style.color = categoryMapping[cellData.rarity].textColor;
            }
          }
          tr.appendChild(td);
          cellIndex++;
        }
        table.appendChild(tr);
      }
      let container = document.getElementById("cardContainer");
      container.innerHTML = "";
      container.appendChild(table);
    }

    /********** EVENT LISTENER **********/
    document.getElementById("renderButton").addEventListener("click", function() {
      let inputText = document.getElementById("inputList").value;
      let cells = parseInput(inputText);
      renderCard(cells);
    });
  </script>
</body>
</html>
